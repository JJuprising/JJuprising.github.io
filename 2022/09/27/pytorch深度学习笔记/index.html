<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>pytorch深度学习笔记 | yjchen</title><meta name="keywords" content="python,深度学习"><meta name="author" content="JJuprising"><meta name="copyright" content="JJuprising"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="pytorch深度学习笔记"><meta name="application-name" content="pytorch深度学习笔记"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="pytorch深度学习笔记"><meta property="og:url" content="https://jjuprising.github.io/2022/09/27/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html"><meta property="og:site_name" content="yjchen"><meta property="og:description" content="基础知识机器学习机器学习三大范式  监督学习，数据+标签 无监督学习，大数据没法给标签，根据相似性将用户自动分成几类 同一类人群，产品可以互推   强化学习 扫地机器人，撞到扣分，没撞到加分    K邻近聚类算法  簇的个数是超参数，假设是3 随机选三个中心点，计算中心点和其他点的距离，求平均距离"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://jjuprising.github.io/img/default.jpg"><meta property="article:author" content="JJuprising"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://jjuprising.github.io/img/default.jpg"><meta name="description" content="基础知识机器学习机器学习三大范式  监督学习，数据+标签 无监督学习，大数据没法给标签，根据相似性将用户自动分成几类 同一类人群，产品可以互推   强化学习 扫地机器人，撞到扣分，没撞到加分    K邻近聚类算法  簇的个数是超参数，假设是3 随机选三个中心点，计算中心点和其他点的距离，求平均距离"><link rel="shortcut icon" href="/images/sta_logo.jpg"><link rel="canonical" href="https://jjuprising.github.io/2022/09/27/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: JJuprising","link":"链接: ","source":"来源: yjchen","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'yjchen',
  title: 'pytorch深度学习笔记',
  postAI: '',
  pageFillDescription: '基础知识, 机器学习, K邻近, 多层感知机, 激活函数, 损失函数, 梯度下降, 什么是梯度下降, 神经网络与梯度下降, 超参数, 学习率, 如何设置和调整学习率, 卷积神经网络, 卷积, 采样层(池化层pooling), 最大池化, 如何进行, 池化的性质, 激活函数, 线性方程, 待解决问题, 非线性, 输出需要进行分类, 输入可能特别大, 线性方程梯度与输入无关了, 激活函数, 全连接层, 编码器解码器, , 深度学习, 残差网络Resnet, 注意力机制, 组件, Pytorch, 加载数据, 数据的组织形式, Tensorboard, add_scalar, add_image(), Transform, tensor数据类型, ToTensorampNormalize, resize(), Compose(), RandomCrop(), 总结, 和transform联动, DataLoader, 神经网络, 卷积操作, 卷积层, 池化层, 非线性激活 Non-linear, 线性层及其他层, CRAF10小实战及Sequential()基础知识机器学习机器学习三大范式监督学习数据标签无监督学习大数据没法给标签根据相似性将用户自动分成几类同一类人群产品可以互推强化学习扫地机器人撞到扣分没撞到加分邻近聚类算法簇的个数是超参数假设是随机选三个中心点计算中心点和其他点的距离求平均距离改变中心点如果距离要小说明更合适作为中心点中心点改变有多种策略如何选取簇对于多维两两选择特征画图多画几个看能分成几个簇然后直接选最大的那个如果在报告里就做主成分分析找出最具代表性的特征两两组合判断簇个数然后开始聚类随机初始化选簇然后进行聚类计算目的就是逐渐逼近一个最优解聚类算法在里有开源代码邻近传播算法多层感知机激活函数损失函数梯度下降什么是梯度下降作用优化损失函数找极小值损失函数要找最小梯度梯度就是函数对它的各个自变量求偏导后由偏导数组成的一个向量简单来说就是导数多了方向这个很关键后面提到在下图情况有可能陷入局部最小值也就是左边最小值但他不是全局最小因此就需要随机初始化几次多尝试几次那么如何找呢以一元二次函数为例假设红点处是一个初始值我们对该点进行求导导函数当减小也就是黑色箭头方向导数是在减小的代表导数反方向橙色箭头方向导数增加代表导数正向为了找到极小值我们需要让红点朝着黑色方向移动这就是梯度下降的目的实现这一过程需要提到学习率让减去学习率乘以函数的导数学习率的目的是控制更新的幅度如果小那么每次更新的幅度就小进行迭代更新曲线逐渐平缓最终会收敛到一个局部的极值点也就是当导数无限逼近最终停留在极值点全世界最通俗易懂的梯度下降法详解优化函数大法知乎神经网络与梯度下降神经网络方面的一个巨大突破是从函数转换到一个函数为什么使用在轴负向梯度会接近学习速度变得很慢而换用对于输入的负值梯度都是不会趋向逐渐减少到这使得梯度下降算法运行得更快超参数学习率学习率决定了在每步参数更新中模型参数有多大程度或多快多大步长的调整学习率是在梯度下降的过程中更新权重时的超参数即下面公式中的学习率越低损失函数的变化速度就越慢容易过拟合虽然使用低学习率可以确保我们不会错过任何局部极小值但也意味着我们将花费更长的时间来进行收敛特别是在被困在局部最优点的时候而学习率过高容易发生梯度爆炸振动幅度较大模型难以收敛学习率的影响如何设置和调整学习率调整学习率的套路通常是先设置一个初始学习率这个初始学习率应该让损失尽可能快地降低然后训练过程中按照一定的降低学习率或用算法根据实际训练情况自适应地调整学习率另外在正式开始训练之前还应该有一小段热身的过程热身的原因是一开始模型参数是完全随机的需要谨慎地更新参数不能一上来就用初始学习率卷积神经网络简单神经网络和卷积神经网络卷积神经网络起到一个分类器的作用卷积层负责提取特征采样层负责特征选择全连接层负责分类卷积卷积层如何提取特征呢用到卷积核又叫滤波器是可以用来提取特征的卷积核放在神经网络里就代表对应的权重卷积核和图像进行点乘就代表卷积核里的权重单独对相应位置的进行作用至于为什么要把点乘完所有结果加起来实际上就是把所有作用效果叠加起来我们知道输入知道神经元的权值了根据神经网络公式还需要设置偏置先假设为我们分别对三个分量的其中一个的九宫格进行卷积所以结果为三个卷积核的输出为什么要叠加在一起呢你可以理解为三个颜色特征分量叠加成特征分量但是不能够对随即找然后进行卷积除了特征值还有相对位置需要考虑因此也需要按照正确的顺序去进行卷积最经典的就是从左到右每隔列向右移动一次卷积核进行卷积可以自己定义到达最右从上到下每隔行向下移动一次卷积核移动完成再继续如上所述从左到右进行就这样我们先从左到右再从上到下直到所有都被卷积核过了一遍完成输入图片的第一层卷积层的特征提取这里的我们叫作就是步长的意思如果我们就是相当每隔两行或者两列进行卷积同时我们可以看到分量的外面还围了一圈称为补相当于什么信息都没加对比补了和没补同样一行补执行了多几次的卷积操作好处在于可以获得更多细致特征信息比如图像的边缘信息我们可以控制卷积层输出的特征图的从而可以达到控制网络结构的作用还是以上面的例子如果没有做以及第二层卷积层的卷积核仍然是那么第二层卷积层输出的特征图就是的特征提取就这么结束了同样的情况下加了的第二层卷积层输出特征图仍然为这样我们可以再增加一层卷积层提取更深层次的特征卷积神经网络入门讲解知乎采样层池化层最大池化最大池化字面意思就是直接取最大的例如下面矩阵图数值代表特征程度最大池化选择含义就是代表这个区域最符合特征的然后去掉没有的为什么要这么做作者举了个很形象的例子比如这里四个美女要选一个每个人的选择都是最符合自己的也就是四个中最符合的特征其他的丢掉那为什么不能都选呢不做首先你娶回个她们会各种勾心斗角让你崩溃然后你会有巨大的经济压力身体也吃不消参数过多导致运算量大最后可能还会难以平衡婆上一次卷积层媳或者母子下一层卷积层关系无法满足模型结构需求如何进行例如下图可以类比卷积就是一个的卷积核为从左到右从上到下作用是选取核里最大的值而不是做卷积运算池化的性质可以一定程度提高空间不变性比如说平移不变性尺度不变性形变不变性空间不变性体现在卷积是对一个区域一个区域进行卷积关注单独区域的特征以及特征之间的相对位置当图像发生细微变化经过卷积和输出结果和原来差别可能不大甚至很小平移不变性图像经过一个小小的平移之后依然产生相同的池化特征激活函数在接触到深度学习后特别是神经网络中我们会发现在每一层的神经网络输出后都会使用一个函数比如等等对结果进行运算这个函数就是激活函数为什么要激活函数简而言之因为神经网络每层输入输出都是线性求和过程不管怎么叠加变换都是线性组合不能解决非线性问题而通过激活函数可以使神经网络逼近任何非线性函数应用于复杂的非线性分类问题我们从最简单的开始讲线性方程下图就是一个最简单的神经元其实就是一个线性方程然而这个神经网络只能够解决普通的线性二分类问题比如现实中其实更多的都是复杂的二分类具有非线性的特点那么怎么做呢首先叠加神经网络行不行这里我们对神经元进行叠加列出公式我们假设那么这又回到了一个线性方程由于线性函数具有可加性和其次性所以仅靠简单的叠加是不能够解决非线性问题的待解决问题非线性那如何将线性神经网络转为非线性呢我们首先想到二次函数某一个二次函数经过调整可以将非线性问题进行分类输出需要进行分类我们的神经网络还是最简单的根据的值我们会得到值所以我们需要一个函数可以对得到的值进行分类的比如大于分类为小于分类为输入可能特别大对于神经网络我们需要算出输出误差来更新权值如果输出绝对值太大甚至无限大那么输出会特别大直接导致非常大那么更新出来的权值没有意义或无法更新权值线性方程梯度与输入无关了线性神经网络导数为常数那么梯度就与输入无关了在反向传播时候梯度改变也变为常数和输入的改变关联不上了激活函数解决上面的问题就需要激活函数了入门讲解什么是激活函数知乎全连接层全连接层的作用主要就是实现分类训练完到最后一步猫头猫尾猫再往前可以做对子特征进行分类猫眼猫胡须猫头这些细节特征哪来的呢就是从前面的卷积层下采样层来的二层全连接全连接层对模型的影响因素全连接层的总层数长度单个全连接层的神经元数宽度激活函数作用增加模型的非线性表达能力如果全连接层宽度不变增加长度总层数优点全连接层数加深模型非线性表达能力提高理论上都可以提高模型的学习能力如果全连接层长度不变增加宽度神经元个数优点神经元个数增加模型复杂度提升理论上可以提高模型的学习能力难度长度和宽度都是越多越好肯定不是缺点学习能力太好容易造成过拟合缺点运算时间增加效率变低那么怎么判断模型学习能力如何看以及在其他条件理想的情况下如果高低也就是过拟合了可以尝试去减少层数或者参数如果低说明模型学的不好可以尝试增加参数或者层数至于是增加长度和宽度这个又要根据实际情况来考虑了编码器解码器表征学习数据压缩特征降维编码器学习数据的特征逐步压缩输入信息目的是将所有必要信息编码到一个抽象的表示中解码器的任务是将编码器输出的内部表示转换为目标序列解码器逐步生成输出序列每一步都可能依赖于前一步的输出以及从编码器传递过来的上下文信息在生成过程中解码器逐渐解开编码器压缩的信息将其转化为有意义的输出在这个抽象可以给一些随机数如果模型学习的好应该能够出来一个和相近的结果输入数据要洗牌从不同角度观察保证多样性定义编码器输入序列的嵌入层使用作为循环网络层维度是嵌入层的输出维度是的输出定义解码器线性层将隐藏状态转换为输出维度是需要增加一个维度成为嵌入层的输出维度是解码器的同时接收当前输入和上下文向量将的输出通过线性层转换为最终的预测结果函数能让我们知道工具箱以及工具箱中的分隔区有什么东西函数能让我们知道每个工具是如何使用的工具的使用方法或者三个区域编写代码的文件整体运行文件的块是所有行的代码适用大型项目每次都是整体运行的控制台以任意行为块变量属性在右边查看出现错误可阅读性大大降低同控制台执行块可以直接修改块中的错误阅读性加强环境需要配置深度学习残差网络封私信条消息为什么残差连接的网络结构更容易学习知乎注意力机制组件查询代表需要获取信息的请求键与相关性的衡量标准值包含需要被提取信息的实际数据权重通过和的相似度计算得来决定了从各个中提取多少信息举例说明假设我们有一个简单的句子猫喜欢追逐老鼠如果我们要对喜欢这个词进行编码一个简单的方法是只看这个词本身但这样会忽略它的上下文喜欢的对象是猫而被喜欢的是追逐老鼠在这里猫和追逐老鼠就是喜欢的上下文而注意力机制能够帮助模型更好地捕获这种上下文关系使用实现简单的点积注意力初始化对应于喜欢的编码对应于猫追逐老鼠的编码也对应于猫追逐老鼠的编码计算注意力权重计算注意力输出注意力权重注意力输出输出注意力权重注意力输出这里喜欢通过注意力权重与猫和追逐老鼠进行了信息的融合并得到了一个新的编码从而更准确地捕获了其在句子中的语义信息解码注意力机制从技术解析到实战代码博客加载数据一堆数据提供一种方式去获取数据及其为后面的网络提供不同的数据形式如何获取每一个数据及其告诉我们总共有多少数据数据的组织形式文件夹名就是一个图片对应图片的文字坐标信息图片名就是实战案例数据集文件夹数据集标签拼接路径这里正好文件夹名就是标签名将文件夹下图片转换成列表是索引获取单张图片名字拼接获得单张图的地址图片读取获取标签长度即数据集的列表长度大路径蚂蚁标签蜜蜂标签实例化蚂蚁实例化蜜蜂拼接数据集看模块的代码按住点模块打开窗口不接默认打开端口的标题轴轴重新画删掉文件下下的所有文件在终端结束后重新打开窗口读取到的数据是型从到需要在中指定中每一个数字维表示的含义默认是即通道高度宽度如果导入图片是就要加入说明见案例打开图片转成型验证时型检查图片的形状发现是即高度宽度通道对应图片的形状工具箱有等工具用于处理图片输出想要的图片结果的使用数据类型在括号内查看要输入的参数数据类型转成类型标准差接上面代码原图的大小改大小中的参数需要一个列表中列表的表示形式为数据数据在中数据需要是类型所以得到的参数参数将几步打包成一步只改了宽没改长随机裁剪出一部分设置不同步数总结关注输入和输出多看官方文档关注方法需要什么参数不知道返回值的时候调试数据集的使用官网文档的下有很多数据集可以使用提供训练好的模型上面讲了提供小工具下载训练集下载测试集的形式发现第一个是图片第二个是查看图片有哪些类型调式看有属性接收和联动设置加入参数结果准备测试数据集测试数据集中第一张照片及返回值是设定的一组图片打包的和神经网络是所有神经网络的基类隐藏层经过一次卷积然后一次非线性输出卷积操作各种参数表示卷积核在输入图像上移动一格对应格相乘得到数从左到右到边界回到最左向下移动然后重复操作只有两个参数不能直接放进卷积要矩阵变成四个参数输出卷积层一维卷积二维卷积层彩色图像一般是三通道参数表输入通道数输出通道数卷积核大小卷积操作步径大小边缘填充卷积核距离后面都是默认参数卷积层示例动图要梯子才能刷出来设置为时会生成两个卷积核得到两个叠加的输出一般卷积操作会不断增加数例子原本输出通道数变两倍这一步相当于切开放到一个池化层向下取整向上取整默认不够对应不取值实现最大池化声明一下类型否则报错注意当设置为结果当设置为结果最大池化目的为了保持原先数据的特征同时减少数据量加快训练速度例如也能大致看明白视频内容例子最大池化可以看到输出图片变模糊了非线性激活用到或主要目的在网络中引入更多非线性特征才能训练出符合更多特征的模型线性层及其他层表示要不要设置偏振展平成一行小实战及由公式计算第一步卷积得到是默认设置为通过对每一步的解析我们建立出一个简单的模型代码如下提供的一个假设的输入',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-07 20:37:43',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/./images/ava.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">yjchen</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 1.05rem;">C++<sup>1</sup></a><a href="/tags/DL/" style="font-size: 1.05rem;">DL<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem;">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>2</sup></a><a href="/tags/c/" style="font-size: 1.05rem;">c++<sup>1</sup></a><a href="/tags/html/" style="font-size: 1.05rem;">html<sup>2</sup></a><a href="/tags/javascript/" style="font-size: 1.05rem;">javascript<sup>1</sup></a><a href="/tags/minecraft/" style="font-size: 1.05rem;">minecraft<sup>1</sup></a><a href="/tags/python/" style="font-size: 1.05rem;">python<sup>2</sup></a><a href="/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 1.05rem;">云服务器<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.05rem;">前端<sup>1</sup></a><a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.05rem;">小程序<sup>1</sup></a><a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 1.05rem;">教程<sup>2</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 1.05rem;">数学<sup>2</sup></a><a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 1.05rem;">服务器<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">笔记<sup>8</sup></a><a href="/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/" style="font-size: 1.05rem;">经验分享<sup>1</sup></a><a href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" style="font-size: 1.05rem;">编程语言<sup>6</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 1.05rem;">项目<sup>5</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="url">深度学习</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/python/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>python</span></a><a class="article-meta__tags" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>深度学习</span></a></span></div></div><h1 class="post-title" itemprop="name headline">pytorch深度学习笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2022-09-27T13:01:14.000Z" title="发表于 2022-09-27 21:01:14">2022-09-27</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-05-07T12:37:43.581Z" title="更新于 2024-05-07 20:37:43">2024-05-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为广州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>广州</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/img/default.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://jjuprising.github.io/2022/09/27/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><header><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="url">深度学习</a><a href="/tags/python/" tabindex="-1" itemprop="url">python</a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" tabindex="-1" itemprop="url">深度学习</a><h1 id="CrawlerTitle" itemprop="name headline">pytorch深度学习笔记</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">JJuprising</span><time itemprop="dateCreated datePublished" datetime="2022-09-27T13:01:14.000Z" title="发表于 2022-09-27 21:01:14">2022-09-27</time><time itemprop="dateCreated datePublished" datetime="2024-05-07T12:37:43.581Z" title="更新于 2024-05-07 20:37:43">2024-05-07</time></header><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><h2 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h2><p>机器学习三大范式</p>
<ul>
<li>监督学习，数据+标签</li>
<li>无监督学习，大数据没法给标签，根据相似性将用户自动分成几类<ul>
<li>同一类人群，产品可以互推</li>
</ul>
</li>
<li>强化学习<ul>
<li>扫地机器人，撞到扣分，没撞到加分</li>
</ul>
</li>
</ul>
<h3 id="K邻近"><a href="#K邻近" class="headerlink" title="K邻近"></a>K邻近</h3><p>聚类算法</p>
<ul>
<li>簇的个数是超参数，假设是3</li>
<li>随机选三个中心点，计算中心点和其他点的距离，求平均距离</li>
<li>改变中心点，如果距离要小，说明更合适作为中心点</li>
<li>中心点改变有多种策略</li>
</ul>
<p>如何选取簇，对于多维，两两选择特征画图，多画几个看能分成几个簇，然后直接选最大的那个</p>
<p>如果在报告里，就做主成分分析，找出最具代表性的特征，两两组合判断簇个数，然后开始聚类</p>
<p>随机初始化选簇，然后进行聚类计算。目的就是逐渐逼近一个最优解</p>
<p>聚类算法</p>
<ul>
<li>DBSCAN，在skilearn里有开源代码</li>
<li>AP邻近传播算法</li>
</ul>
<h2 id="多层感知机"><a href="#多层感知机" class="headerlink" title="多层感知机"></a>多层感知机</h2><h2 id="激活函数"><a href="#激活函数" class="headerlink" title="激活函数"></a>激活函数</h2><h2 id="损失函数"><a href="#损失函数" class="headerlink" title="损失函数"></a>损失函数</h2><h2 id="梯度下降"><a href="#梯度下降" class="headerlink" title="梯度下降"></a>梯度下降</h2><h3 id="什么是梯度下降"><a href="#什么是梯度下降" class="headerlink" title="什么是梯度下降"></a>什么是梯度下降</h3><p>作用：优化损失函数</p>
<p>找极小值(损失函数要找最小)</p>
<p>梯度：梯度就是函数对它的各个自变量求偏导后，由偏导数组成的一个向量。简单来说就是导数多了<strong>方向</strong>(这个很关键，后面提到)</p>
<p>在下图情况有可能陷入局部最小值，也就是左边最小值，但他不是全局最小</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic3.zhimg.com/80/v2-239bdd1d0c195438ade5ba598a3c5552_720w.webp" alt="img"></p>
<p>因此，就需要随机初始化几次，多尝试几次</p>
<p>那么如何找呢，以一元二次函数f(x)&#x3D;(x-1)^2+1为例</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/80/v2-0f23b351799a1cb70f9a1f71f743d160_720w.webp" alt="img"></p>
<p>假设红点处是一个初始值，我们对该点进行求导，导函数fx&#x3D;2x-2，当x减小，也就是黑色箭头方向，导数是在减小的，代表导数反方向；橙色箭头方向，导数增加，代表导数正向。</p>
<p>为了找到极小值，我们需要让红点x朝着黑色方向移动，这就是梯度下降的目的。实现这一过程，需要提到<strong>学习率eta</strong><br>$$<br>x\leftarrow x-eta*\frac{df(x)}{dx}<br>$$<br>让x减去学习率eta乘以函数的导数。学习率eta的目的是控制x更新的幅度，如果eta小，那么x每次更新的幅度就小</p>
<p>进行迭代更新，曲线逐渐平缓，最终会收敛到一个局部的极值点，也就是当导数无限逼近0，最终停留在极值点。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic3.zhimg.com/80/v2-0d352837d300670f0bcf4d6d7de519c2_720w.webp" alt="img"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/261375491">Gradient-Descent（全世界最通俗易懂的梯度下降法详解-优化函数大法） - 知乎 (zhihu.com)</a></p>
</blockquote>
<h3 id="神经网络与梯度下降"><a href="#神经网络与梯度下降" class="headerlink" title="神经网络与梯度下降"></a>神经网络与梯度下降</h3><p>神经网络方面的一个巨大突破是从 <strong>sigmoid</strong> 函数转换到一个 <strong>ReLU</strong> 函数,<strong>Rectified Linear Unit</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.assets/image-20240407202927937.png" alt="image-20240407202927937"></p>
<p>为什么？</p>
<p>使用sigmoid，在x轴负向，梯度会接近0，学习速度变得很慢</p>
<p>而换用ReLU，对于输入的负值，梯度都是0，不会趋向逐渐减少到0，这使得<strong>梯度下降</strong>算法运行得更快。</p>
<h2 id="超参数"><a href="#超参数" class="headerlink" title="超参数"></a>超参数</h2><h3 id="学习率"><a href="#学习率" class="headerlink" title="学习率"></a>学习率</h3><p>学习率决定了在每步参数更新中，模型参数有多大程度（或多快、多大步长）的调整</p>
<p>学习率是在梯度下降的过程中更新权重时的超参数，即下面公式中的eta<br>$$<br>x\leftarrow x-eta*\frac{df(x)}{dx}<br>$$<br>学习率越低，<strong>损失函数的变化速度就越慢</strong>，容易过拟合。虽然使用低学习率可以确保我们不会错过任何局部极小值，但也意味着我们将花费更长的时间来进行收敛，特别是在被困在局部最优点的时候。而学习率过高容易发生梯度爆炸，loss振动幅度较大，模型难以收敛。</p>
<p>学习率的影响：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic3.zhimg.com/80/v2-ed6451ac1a140e12dfd80625ceb15166_720w.webp" alt="img"></p>
<h4 id="如何设置和调整学习率"><a href="#如何设置和调整学习率" class="headerlink" title="如何设置和调整学习率"></a>如何设置和调整学习率</h4><p>调整学习率的套路通常是：</p>
<ul>
<li>先设置一个初始学习率。这个初始学习率应该让损失尽可能快地降低。</li>
<li>然后训练过程中按照一定的schedule降低学习率；或用算法根据实际训练情况，自适应地调整学习率。</li>
</ul>
<p>另外，在正式开始训练之前， 还应该有一小段热身的过程。热身的原因是一开始模型参数是完全随机的，需要谨慎地更新参数，不能一上来就用初始学习率。</p>
<h2 id="卷积神经网络"><a href="#卷积神经网络" class="headerlink" title="卷积神经网络"></a>卷积神经网络</h2><p>简单神经网络和卷积神经网络</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.assets/image-20240407202301840.png" alt="image-20240407202301840"></p>
<p>卷积神经网络起到一个分类器的作用</p>
<p><strong>卷积层负责提取特征，采样层负责特征选择，全连接层负责分类</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic3.zhimg.com/v2-05f7af4e1d59e82412832c01b1144f52_b.jpg" alt="img"></p>
<h3 id="卷积"><a href="#卷积" class="headerlink" title="卷积"></a>卷积</h3><p>卷积层如何提取特征呢？</p>
<p>用到卷积核又叫滤波器，(convolution kernel）是可以用来提取特征的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic4.zhimg.com/v2-c9b00043ba326451979abda5417bfcdf_b.jpg" alt="img"></p>
<p><strong>卷积核放在神经网络里，就代表对应的权重（weight)</strong></p>
<p><strong>卷积核和图像进行点乘（dot product),</strong> <strong>就代表卷积核里的权重单独对相应位置的Pixel进行作用</strong></p>
<p>至于为什么要把点乘完所有结果加起来，实际上就是把所有作用效果叠加起来</p>
<p>我们知道输入，知道神经元的权值（weights）了，根据神经网络公式：<br>$$<br>\sum_iw_ix_i+b<br>$$<br>还需要设置偏置bias，先假设为0</p>
<p>我们分别对三个分量的其中一个3x3的九宫格进行卷积</p>
<p>所以，结果为：</p>
<p>W1output &#x3D; 1*(-1) +1<em>1+1</em>0+0*(-1)+1<em>0+2</em>1+0*(-1)+1<em>1+2</em>(-1) &#x3D;1</p>
<p>W2output &#x3D; 2<em>1+2</em>0+1<em>1+1</em>1+0<em>1+0</em>2+0<em>1+0</em>0+1*1&#x3D;5</p>
<p>W3output &#x3D; 1*(-1)+1*(-1)+0*(-1)+0<em>2+0</em>(1)+0<em>2+1</em>0+1<em>1+0</em>1 &#x3D; -1</p>
<p>Bias &#x3D; 0</p>
<p>Final_output &#x3D;<strong>W1output + W2output+W3output+bias</strong>&#x3D; 1+5-1+0 &#x3D; 5</p>
<p>三个卷积核的输出为什么要叠加在一起呢</p>
<p><strong>你可以理解为三个颜色特征分量叠加成RGB特征分量</strong></p>
<p>但是，不能够对pixels随即找然后进行卷积，除了特征值，还有相对位置需要考虑。</p>
<p>因此，也需要按照正确的顺序去进行卷积。</p>
<p>最经典的就是从左到右，每隔x列Pixel，向右移动一次卷积核进行卷积(x可以自己定义)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-0e86ac3e69a31e47477f658b76842c7c_b.jpg" alt="img"></p>
<p>到达最右。从上到下，每隔y行pixel,向下移动一次卷积核，移动完成，再继续如上所述，从左到右进行</p>
<p>就这样，我们先从左到右，再从上到下，直到所有pixels都被卷积核过了一遍，完成输入图片的第一层卷积层的特征提取</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/v2-8d0c46394cac2f192e236c7cffff2559_b.jpg" alt="img"></p>
<p><strong>这里的x我们叫作stride,就是步长的意思，如果我们x &#x3D; 2, 就是相当每隔两行或者两列进行卷积</strong></p>
<p>同时我们可以看到，分量的pixel 外面还围了一圈0，称为补0(相当于什么信息都没加)。对比补了0和没补0，同样一行，补0执行了多几次的卷积操作，好处在于：</p>
<ul>
<li><p>可以获得更多细致特征信息，比如图像的<strong>边缘信息</strong></p>
</li>
<li><p>我们可以控制卷积层输出的特征图的size，从而可以达到<strong>控制网络结构的作用</strong>，还是以上面的例子，如果没有做zero-padding以及第二层卷积层的卷积核仍然是3x3, 那么第二层卷积层输出的特征图就是1x1，CNN的特征提取就这么结束了。</p>
<p><strong>同样的情况下加了zero-padding的第二层卷积层输出特征图仍然为5x5,这样我们可以再增加一层卷积层提取更深层次的特征</strong></p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/column/c_141391545">卷积神经网络（CNN）入门讲解 - 知乎 (zhihu.com)</a></p>
<h3 id="采样层-池化层，pooling"><a href="#采样层-池化层，pooling" class="headerlink" title="采样层(池化层，pooling)"></a>采样层(池化层，pooling)</h3><h4 id="最大池化"><a href="#最大池化" class="headerlink" title="最大池化"></a>最大池化</h4><p>最大池化Maxpooling字面意思就是，直接取最大的</p>
<p>例如下面矩阵图，数值代表特征程度</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picx.zhimg.com/v2-c03717a0e283578ab302075c1c1fe029_720w.jpg?source=d16d100b" alt="img"></p>
<p>最大池化选择9，含义就是9代表这个区域，最符合特征的，然后去掉没有的。</p>
<p>为什么要这么做？作者举了个很形象的例子</p>
<p>比如这里四个美女要选一个，每个人的选择都是最符合自己的(也就是四个中最符合的特征)，其他的丢掉</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picx.zhimg.com/v2-642db2909cdf8230fdcf509b85746556_720w.jpg?source=d16d100b" alt="img"></p>
<p>那为什么不能都选呢？——不做Maxpooling</p>
<p>首先你娶回4个，她们会各种勾心斗角，让你崩溃<strong>（overfitting）</strong></p>
<p>然后你会有巨大的经济压力，身体也吃不消<strong>（参数过多导致运算量大）</strong></p>
<p>最后可能还会难以平衡婆（上一次卷积层）媳或者母子（下一层卷积层）关系<strong>（无法满足模型结构需求）</strong></p>
<h4 id="如何进行"><a href="#如何进行" class="headerlink" title="如何进行"></a>如何进行</h4><p>例如下图 ，可以类比卷积，就是一个2X2的卷积核，stride为2，从左到右从上到下，作用是选取核里最大的值，而不是做卷积运算</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-16b276fe8c010af144383da29336c1e9_720w.jpg?source=d16d100b" alt="img"></p>
<h4 id="池化的性质"><a href="#池化的性质" class="headerlink" title="池化的性质"></a>池化的性质</h4><p><strong>可以一定程度提高空间不变性</strong>，比如说平移不变性，尺度不变性，形变不变性</p>
<p>空间不变性体现在，卷积是对一个区域一个区域进行卷积，CNN关注单独区域的特征以及特征之间的相对位置。</p>
<p>当图像发生细微变化，经过卷积和maxpooling，输出结果和原来差别可能不大甚至很小</p>
<p>平移不变性：图像经过一个小小的平移之后，依然产生相同的池化特征</p>
<h3 id="激活函数-1"><a href="#激活函数-1" class="headerlink" title="激活函数"></a>激活函数</h3><p>在接触到深度学习（Deep Learning）后，特别是神经网络中，我们会发现在<strong>每一层的神经网络输出后都会使用一个函数</strong>（比如sigmoid，tanh，Relu等等）对结果进行运算，这个函数就是激活函数（Activation Function）。</p>
<p>为什么要激活函数？简而言之因为神经网络每层输入输出都是线性求和过程，不管怎么叠加变换，都是线性组合不能解决非线性问题。而通过激活函数可以使神经网络逼近任何非线性函数，应用于复杂的非线性分类问题</p>
<p>我们从最简单的开始讲</p>
<h4 id="线性方程"><a href="#线性方程" class="headerlink" title="线性方程"></a>线性方程</h4><p>下图就是一个最简单的神经元，Y&#x3D;W*X1+1，其实就是一个线性方程</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/v2-5fa9312ed3aecb8c3f84c437e4933dd9_b.jpg" alt="img"></p>
<p>然而，这个神经网络只能够解决普通的线性二分类问题，比如</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic4.zhimg.com/v2-825e4434307215b82ee5607512d1695b_b.jpg" alt="img"></p>
<p>现实中，其实更多的都是复杂的二分类，具有非线性的特点。那么怎么做呢？</p>
<p>首先叠加神经网络行不行？这里我们对神经元进行叠加，列出公式</p>
<p>Output &#x3D; w7(input1<em>w1 +input2</em>w2)+w8(input1<em>w3+input2</em>w4)+w9(input1<em>w5+input2</em>w6)</p>
<p>Output &#x3D; input1(w1<em>w7+w3</em>w8+w9<em>w5)+input2</em>(w2<em>w7+w4</em>w8+w6*w9)</p>
<p>我们假设Output &#x3D; 0 </p>
<p>那么input1 &#x3D; input2*( w2<em>w7+w4</em>w8+w6<em>w9)&#x2F;(-w2</em>w7+w4<em>w8+w6</em>w9)</p>
<p>这又回到了一个线性方程。由于线性函数具有可加性和其次性，所以仅靠简单的叠加是不能够解决非线性问题的。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-99edcb8c87dbcdc5eb2884cf7076884c_b.jpg" alt="img"></p>
<h4 id="待解决问题"><a href="#待解决问题" class="headerlink" title="待解决问题"></a>待解决问题</h4><h5 id="非线性"><a href="#非线性" class="headerlink" title="非线性"></a>非线性</h5><p>那如何将线性神经网络转为非线性呢？我们首先想到二次函数y&#x3D;wx<sup>2</sup>+B</p>
<p>某一个二次函数经过调整，可以将非线性问题进行分类：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/v2-10f91a9a61f22aea9a46ebaf63c1e3ad_b.jpg" alt="img"></p>
<h5 id="输出需要进行分类"><a href="#输出需要进行分类" class="headerlink" title="输出需要进行分类"></a>输出需要进行分类</h5><p>我们的神经网络（还是最简单的）</p>
<p>Y &#x3D;W*X +B</p>
<p>根据input X的值，我们会得到Y值</p>
<p>所以我们需要一个函数可以对得到的Y值进行分类的</p>
<p>比如Y大于0 ，分类为1</p>
<p>小于0 ，分类为0</p>
<h5 id="输入可能特别大"><a href="#输入可能特别大" class="headerlink" title="输入可能特别大"></a>输入可能特别大</h5><p>对于神经网络Y&#x3D;W*X+B，我们需要算出输出误差error (output Y - target Y) 来更新权值</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic3.zhimg.com/v2-b50b34f6c48a49968de2d7b6de79b7e6_b.jpg" alt="img"></p>
<p>如果输出X绝对值太大甚至无限大，那么输出Y会特别大，直接导致Error非常大，那么更新出来的权值没有意义或无法更新权值</p>
<h5 id="线性方程梯度与输入无关了"><a href="#线性方程梯度与输入无关了" class="headerlink" title="线性方程梯度与输入无关了"></a>线性方程梯度与输入无关了</h5><p>线性神经网络导数为常数，那么梯度gradient就与输入X无关了</p>
<p>在反向传播时候，梯度改变也变为常数，和输入的改变关联不上了</p>
<h4 id="激活函数-2"><a href="#激活函数-2" class="headerlink" title="激活函数"></a>激活函数</h4><p>解决上面的问题，就需要激活函数了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-17708ef17113fc120b045db3de3dbaac_b.jpg" alt="img"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/32824193">CNN入门讲解：什么是激活函数（Activation Function） - 知乎 (zhihu.com)</a></p>
</blockquote>
<h3 id="全连接层"><a href="#全连接层" class="headerlink" title="全连接层"></a>全连接层</h3><p>全连接层的作用主要就是实现分类（Classification）</p>
<p>训练完到最后一步：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic4.zhimg.com/80/v2-ba7629e4fb2996750f870a1d85bca863_720w.webp" alt="img"></p>
<p>猫头猫尾…–&gt;猫</p>
<p>再往前可以做对子特征进行分类：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic2.zhimg.com/80/v2-671995a238e33a1c4e669340fed561f5_720w.webp" alt="img"></p>
<p>猫眼猫胡须…–&gt;猫头</p>
<p>这些细节特征哪来的呢？就是从前面的卷积层，下采样层来的。</p>
<p>二层全连接</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic4.zhimg.com/80/v2-27e053826d9779ef8d8a6faba22a6b7b_720w.webp" alt="img"></p>
<p>全连接层对模型的影响因素：</p>
<ol>
<li>全连接层的总层数（长度）</li>
<li>单个全连接层的神经元数（宽度）</li>
<li>激活函数(作用：<strong>增加模型的非线性表达能力</strong>)</li>
</ol>
<p>如果全连接层宽度不变，增加<strong>长度</strong>(总层数)：</p>
<p><strong>优点</strong>：全连接层数加深，模型非线性表达能力提高。理论上都可以提高模型的学习能力。</p>
<p>如果全连接层长度不变，增加<strong>宽度</strong>(神经元个数)：</p>
<p><strong>优点</strong>：神经元个数增加，模型复杂度提升。理论上可以提高模型的学习能力。</p>
<p>难度长度和宽度都是越多越好？</p>
<p>肯定不是</p>
<p>（1）<strong>缺点</strong>：学习能力太好容易造成过拟合。</p>
<p>（2）<strong>缺点</strong>：运算时间增加，效率变低。</p>
<p>那么怎么判断模型学习能力如何？看Training Curve 以及 Validation Curve</p>
<p>在其他条件理想的情况下，如果Training Accuracy 高， Validation Accuracy 低，也就是过拟合 了，可以尝试去减少层数或者参数。</p>
<p>如果Training Accuracy 低，说明模型学的不好，可以尝试增加参数或者层数。至于是增加长度和宽度，这个又要根据实际情况来考虑了。</p>
<h2 id="编码器解码器"><a href="#编码器解码器" class="headerlink" title="编码器解码器"></a>编码器解码器</h2><p>encoder-decoder</p>
<p>表征学习，数据压缩，特征降维</p>
<p>编码器学习数据的特征，逐步压缩输入信息，目的是将所有必要信息编码到一个抽象的表示中</p>
<p> 解码器的任务是将编码器输出的内部表示转换为目标序列。解码器逐步生成输出序列，每一步都可能依赖于前一步的输出以及从编码器传递过来的上下文信息。在生成过程中，解码器逐渐解开编码器压缩的信息，将其转化为有意义的输出</p>
<p>在这个抽象， 可以给一些随机数，如果模型学习的好，应该能够出来一个和x相近的结果</p>
<p>输入数据要洗牌，从不同角度观察，保证多样性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 定义编码器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Encoder</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_dim, emb_dim, hidden_dim, n_layers</span>):</span><br><span class="line">        <span class="built_in">super</span>(Encoder, self).__init__()</span><br><span class="line">        <span class="comment"># 输入序列的嵌入层</span></span><br><span class="line">        self.embedding = nn.Embedding(input_dim, emb_dim)  </span><br><span class="line">        <span class="comment"># 使用GRU作为循环网络层</span></span><br><span class="line">        self.rnn = nn.GRU(emb_dim, hidden_dim, n_layers)   </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, src</span>):</span><br><span class="line">        <span class="comment"># src维度是[seq_len, batch_size]</span></span><br><span class="line">        <span class="comment"># 嵌入层的输出维度是[seq_len, batch_size, emb_dim]</span></span><br><span class="line">        embedded = self.embedding(src)  </span><br><span class="line">        <span class="comment"># GRU的输出</span></span><br><span class="line">        outputs, hidden = self.rnn(embedded)  </span><br><span class="line">        <span class="keyword">return</span> hidden</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 定义解码器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Decoder</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, output_dim, emb_dim, hidden_dim, n_layers</span>):</span><br><span class="line">        <span class="built_in">super</span>(Decoder, self).__init__()</span><br><span class="line">        self.embedding = nn.Embedding(output_dim, emb_dim)</span><br><span class="line">        self.rnn = nn.GRU(emb_dim + hidden_dim, hidden_dim, n_layers)</span><br><span class="line">        <span class="comment"># 线性层，将隐藏状态转换为输出</span></span><br><span class="line">        self.fc = nn.Linear(hidden_dim, output_dim)  </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span>, hidden</span>):</span><br><span class="line">        <span class="comment"># input维度是[batch_size]，需要增加一个维度成为[1, batch_size]</span></span><br><span class="line">        <span class="built_in">input</span> = <span class="built_in">input</span>.unsqueeze(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 嵌入层的输出维度是[1, batch_size, emb_dim]</span></span><br><span class="line">        embedded = self.embedding(<span class="built_in">input</span>)  </span><br><span class="line">        <span class="comment"># 解码器的RNN同时接收当前输入和上下文向量</span></span><br><span class="line">        output, hidden = self.rnn(embedded, hidden)  </span><br><span class="line">        <span class="comment"># 将RNN的输出通过线性层转换为最终的预测结果</span></span><br><span class="line">        prediction = self.fc(output.squeeze(<span class="number">0</span>))  </span><br><span class="line">        <span class="keyword">return</span> prediction, hidden</span><br></pre></td></tr></table></figure>



<ul>
<li><code>dir()</code>函数，能让我们知道工具箱以及工具箱中的分隔区有什么东西。</li>
<li><code>help()</code>函数，能让我们知道每个工具是如何使用的，工具的使用方法。<ul>
<li><code>help(a)</code>或者<code>a??</code></li>
</ul>
</li>
</ul>
<p>三个区域编写代码：</p>
<ul>
<li>pycharm的python文件<ul>
<li>整体运行，python文件的块是所有行的代码，适用大型项目</li>
<li>每次都是整体运行</li>
</ul>
</li>
<li>pycharm的python 控制台<ul>
<li>以任意行为块(Shift+Enter)，变量属性在右边查看</li>
<li>出现错误可阅读性大大降低</li>
</ul>
</li>
<li>Jupyter notebook<ul>
<li>同python控制台，Shift+Enter执行块</li>
<li>可以直接修改块中的错误，阅读性加强</li>
<li>环境需要配置</li>
</ul>
</li>
</ul>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h1 id="深度学习"><a href="#深度学习" class="headerlink" title="深度学习"></a>深度学习</h1><h2 id="残差网络Resnet"><a href="#残差网络Resnet" class="headerlink" title="残差网络Resnet"></a>残差网络Resnet</h2><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/306135761/answer/2491142607?utm_campaign=shareopn&utm_content=group3_Answer&utm_medium=social&utm_psn=1764665330822328320&utm_source=wechat_session">(32 封私信 &#x2F; 2 条消息) 为什么残差连接的网络结构更容易学习？ - 知乎 (zhihu.com)</a></p>
<h1 id="注意力机制"><a href="#注意力机制" class="headerlink" title="注意力机制"></a>注意力机制</h1><h4 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h4><ul>
<li><strong><u>Q</u>uery（查询）</strong>: 代表需要获取信息的请求。</li>
<li><strong><u>K</u>ey（键）</strong>: 与Query相关性的衡量标准。</li>
<li><strong><u>V</u>alue（值）</strong>: 包含需要被提取信息的实际数据。</li>
<li><strong>权重（Attention Weights）</strong>: 通过Query和Key的相似度计算得来，决定了从各个Value中提取多少信息</li>
</ul>
<p>举例说明<br>假设我们有一个简单的句子：“猫喜欢追逐老鼠”。如果我们要对“喜欢”这个词进行编码，一个简单的方法是只看这个词本身，但这样会忽略它的上下文。“喜欢”的对象是“猫”，而被“喜欢”的是“追逐老鼠”。在这里，“猫”和“追逐老鼠”就是“喜欢”的上下文，而注意力机制能够帮助模型更好地捕获这种上下文关系。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用PyTorch实现简单的点积注意力</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化Query, Key, Value</span></span><br><span class="line">Q = torch.tensor([[<span class="number">1.0</span>, <span class="number">0.8</span>]])  <span class="comment"># Query 对应于 &quot;喜欢&quot; 的编码</span></span><br><span class="line">K = torch.tensor([[<span class="number">0.9</span>, <span class="number">0.1</span>], [<span class="number">0.8</span>, <span class="number">0.2</span>], [<span class="number">0.7</span>, <span class="number">0.9</span>]])  <span class="comment"># Key 对应于 &quot;猫&quot;, &quot;追逐&quot;, &quot;老鼠&quot; 的编码</span></span><br><span class="line">V = torch.tensor([[<span class="number">1.0</span>, <span class="number">0.1</span>], [<span class="number">0.9</span>, <span class="number">0.2</span>], [<span class="number">0.8</span>, <span class="number">0.3</span>]])  <span class="comment"># Value 也对应于 &quot;猫&quot;, &quot;追逐&quot;, &quot;老鼠&quot; 的编码</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算注意力权重</span></span><br><span class="line">d_k = K.size(<span class="number">1</span>)</span><br><span class="line">scores = torch.matmul(Q, K.transpose(<span class="number">0</span>, <span class="number">1</span>)) / (d_k ** <span class="number">0.5</span>)</span><br><span class="line">weights = F.softmax(scores, dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算注意力输出</span></span><br><span class="line">output = torch.matmul(weights, V)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;注意力权重:&quot;</span>, weights)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;注意力输出:&quot;</span>, output)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注意力权重: tensor([[<span class="number">0.4761</span>, <span class="number">0.2678</span>, <span class="number">0.2561</span>]])</span><br><span class="line">注意力输出: tensor([[<span class="number">0.9529</span>, <span class="number">0.1797</span>]])</span><br></pre></td></tr></table></figure>


<p>这里，“喜欢”通过注意力权重与“猫”和“追逐老鼠”进行了信息的融合，并得到了一个新的编码，从而更准确地捕获了其在句子中的语义信息。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/magicyangjay111/article/details/132634186">解码注意力Attention机制：从技术解析到PyTorch实战_attention代码pytorch-CSDN博客</a></p>
<h1 id="Pytorch"><a href="#Pytorch" class="headerlink" title="Pytorch"></a>Pytorch</h1><h2 id="加载数据"><a href="#加载数据" class="headerlink" title="加载数据"></a>加载数据</h2><p>一堆数据–&gt;Dataset(提供一种方式去获取数据及其label)–&gt;Dataloader(为后面的网络提供不同的数据形式)</p>
<p>Dataset：</p>
<ul>
<li>如何获取每一个数据及其label</li>
<li>告诉我们总共有多少数据</li>
</ul>
<h3 id="数据的组织形式"><a href="#数据的组织形式" class="headerlink" title="数据的组织形式"></a>数据的组织形式</h3><ul>
<li>文件夹名就是一个label</li>
<li>ocr<ul>
<li>图片</li>
<li>对应图片的文字坐标信息</li>
</ul>
</li>
<li>图片名就是label</li>
</ul>
<p>实战案例：</p>
<p><a target="_blank" rel="noopener" href="http://github.com/JJuprising/upload-img/Snipaste_2022-09-24_23-31-33.png">image-Snipaste_2022-09-24_23-31-33</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyData</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, root_dir, label_dir</span>):</span><br><span class="line">        self.root_dir = root_dir  <span class="comment"># 数据集文件夹</span></span><br><span class="line">        self.label_dir = label_dir  <span class="comment"># 数据集标签</span></span><br><span class="line">        self.path = os.path.join(root_dir, label_dir)  <span class="comment"># 拼接路径 这里正好文件夹名就是标签名</span></span><br><span class="line">        self.img_path = os.listdir(self.path)  <span class="comment"># 将文件夹下图片转换成列表</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):  <span class="comment"># idx是索引</span></span><br><span class="line">        img_name = self.img_path[idx]  <span class="comment"># 获取单张图片名字</span></span><br><span class="line">        img_item_path = os.path.join(self.root_dir, self.label_dir, img_name)  <span class="comment"># 拼接获得单张图的地址</span></span><br><span class="line">        img = Image.<span class="built_in">open</span>(img_item_path)  <span class="comment"># 图片读取</span></span><br><span class="line">        label = self.label_dir  <span class="comment"># 获取标签</span></span><br><span class="line">        <span class="keyword">return</span> img, label</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.img_path)  <span class="comment"># 长度即数据集的列表长度</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root_dir = <span class="string">&quot;dataset/train&quot;</span>  <span class="comment"># 大路径</span></span><br><span class="line">ants_label_dir = <span class="string">&quot;ants&quot;</span>  <span class="comment"># 蚂蚁标签</span></span><br><span class="line">bees_label_dir = <span class="string">&quot;bees&quot;</span>  <span class="comment"># 蜜蜂标签</span></span><br><span class="line">ants_dataset = MyData(root_dir, ants_label_dir)  <span class="comment"># 实例化蚂蚁</span></span><br><span class="line">bees_dataset = MyData(root_dir, bees_label_dir)  <span class="comment"># 实例化蜜蜂</span></span><br><span class="line"></span><br><span class="line">train_dataset = ants_dataset + bees_dataset  <span class="comment"># 拼接数据集</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/JJuprising/JJuprising.github.io">https://cdn.jsdelivr.net/gh/JJuprising/JJuprising.github.io</a></p>
<h2 id="Tensorboard"><a href="#Tensorboard" class="headerlink" title="Tensorboard"></a>Tensorboard</h2><p>看模块的代码：按住Ctrl，点模块</p>
<p>打开窗口，不接<code>--port</code>默认打开6006端口的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tensorboard --logdir=logs --port=6007</span><br></pre></td></tr></table></figure>

<h4 id="add-scalar"><a href="#add-scalar" class="headerlink" title="add_scalar"></a>add_scalar</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from torch.utils.tensorboard import SummaryWriter</span><br><span class="line"></span><br><span class="line">writer=SummaryWriter(&quot;logs&quot;)</span><br><span class="line"></span><br><span class="line">for i in range(100):</span><br><span class="line">    writer.add_scalar(&quot;标题&quot;,y轴,x轴)</span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>

<p>重新画删掉Logs文件下下的所有文件，在终端Ctrl+c结束后重新打开窗口</p>
<h4 id="add-image"><a href="#add-image" class="headerlink" title="add_image()"></a>add_image()</h4><p>opencv读取到的数据是numpy型</p>
<p>从PIL到numpy，需要在add_image()中指定shape中每一个数字&#x2F;维表示的含义，默认是CHW即通道-高度-宽度，如果导入图片是HWC就要加入说明，见案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs&quot;</span>)</span><br><span class="line">image_path = <span class="string">&quot;data/train/ants_image/0013035.jpg&quot;</span></span><br><span class="line">img_PIL = Image.<span class="built_in">open</span>(image_path)  <span class="comment"># 打开图片</span></span><br><span class="line">img_array = np.array(img_PIL)  <span class="comment"># 转成numpy型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(img_array))  <span class="comment"># 验证时numpy型</span></span><br><span class="line"><span class="built_in">print</span>(img_array.shape)  <span class="comment"># 检查图片的形状，发现是HWC，即高度-宽度-通道</span></span><br><span class="line"></span><br><span class="line">writer.add_image(<span class="string">&quot;test&quot;</span>, img_array, dataformats=<span class="string">&quot;HWC&quot;</span>)  <span class="comment"># HWC对应图片的形状</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    writer.add_scalar(<span class="string">&quot;y=2*x&quot;</span>,<span class="number">3</span>*i,i)</span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>

<h2 id="Transform"><a href="#Transform" class="headerlink" title="Transform"></a>Transform</h2><p>transform.py工具箱，有toTensor，resize等工具，用于处理图片输出想要的图片结果</p>
<ul>
<li>transform的使用</li>
<li>tensor数据类型</li>
</ul>
<p>在括号内Ctrl+P查看要输入的参数</p>
<h3 id="tensor数据类型"><a href="#tensor数据类型" class="headerlink" title="tensor数据类型"></a>tensor数据类型</h3><h3 id="ToTensor-amp-Normalize"><a href="#ToTensor-amp-Normalize" class="headerlink" title="ToTensor&amp;Normalize"></a>ToTensor&amp;Normalize</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span>  torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"></span><br><span class="line">writer=SummaryWriter(<span class="string">&quot;logs&quot;</span>)</span><br><span class="line">img=Image.<span class="built_in">open</span>(<span class="string">&quot;dataset/val/ants/800px-Meat_eater_ant_qeen_excavating_hole.jpg&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(img)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ToTensor</span></span><br><span class="line">trans_totensor=transforms.ToTensor()</span><br><span class="line">img_tensor=trans_totensor(img) <span class="comment">#  转成tensor类型</span></span><br><span class="line">writer.add_image(<span class="string">&quot;ToTensor&quot;</span>,img_tensor)</span><br><span class="line"></span><br><span class="line"><span class="comment">#  Normalize</span></span><br><span class="line"><span class="built_in">print</span>(img_tensor[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">trans_norm=transforms.Normalize([<span class="number">3</span>,<span class="number">0.5</span>,<span class="number">0.5</span>],[<span class="number">0.5</span>,<span class="number">0.5</span>,<span class="number">0.5</span>]) <span class="comment">#  标准差</span></span><br><span class="line">img_norm=trans_norm(img_tensor)</span><br><span class="line"><span class="built_in">print</span>(img_norm[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">writer.add_image(<span class="string">&quot;Normalize&quot;</span>,img_norm,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>



<h3 id="resize"><a href="#resize" class="headerlink" title="resize()"></a>resize()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#接上面代码</span></span><br><span class="line"><span class="comment"># Resize</span></span><br><span class="line"><span class="built_in">print</span>(img.size)  <span class="comment"># 原图的大小(800, 534)</span></span><br><span class="line">trans_resize = transforms.Resize((<span class="number">512</span>, <span class="number">512</span>)) <span class="comment"># 改大小</span></span><br><span class="line"><span class="comment"># img PIL -&gt; resize -&gt; img_resize PIL</span></span><br><span class="line">img_resize = trans_resize(img)</span><br><span class="line"><span class="comment"># img_resize PIL -&gt; totensor -&gt; img_resize tensor</span></span><br><span class="line">img_resize=trans_totensor(img_resize)</span><br><span class="line">writer.add_image(<span class="string">&quot;Resize&quot;</span>,img_resize,<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(img_resize)</span><br></pre></td></tr></table></figure>



<h3 id="Compose"><a href="#Compose" class="headerlink" title="Compose()"></a>Compose()</h3><p><code>Compose()</code>中的参数需要一个列表。Python中，列表的表示形式为[数据1，数据2，…]。在<code>Compose</code>中，数据需要是<code>transforms</code>类型，所以得到的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Compose([transforms参数<span class="number">1</span>,transforms参数<span class="number">2</span>,...])</span><br></pre></td></tr></table></figure>

<p>将几步打包成一步：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Compose - resize - 2</span></span><br><span class="line">trans_resize_2 = transforms.Resize(<span class="number">512</span>) <span class="comment"># 只改了宽 没改长</span></span><br><span class="line"><span class="comment"># PIL -&gt; PIL -&gt; tensor</span></span><br><span class="line">tran_compose = transforms.Compose([trans_resize_2, trans_totensor])</span><br><span class="line">img_resize_2 = tran_compose(img)</span><br><span class="line">writer.add_image(<span class="string">&quot;Resize&quot;</span>, img_resize_2, <span class="number">1</span>)</span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>



<h3 id="RandomCrop"><a href="#RandomCrop" class="headerlink" title="RandomCrop()"></a>RandomCrop()</h3><p>随机裁剪出一部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">trans_random = transforms.RandomCrop(<span class="number">512</span>) </span><br><span class="line"><span class="comment"># PIL -&gt; PIL -&gt; tensor</span></span><br><span class="line">tran_compose_2 = transforms.Compose([trans_random, trans_totensor])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>): <span class="comment"># 设置不同步数</span></span><br><span class="line">    img_crop=trans_compose_2(img)</span><br><span class="line">    writer.add_image(<span class="string">&quot;RandomCrop&quot;</span>, img_resize_2, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>



<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li><p>关注输入和输出</p>
</li>
<li><p>多看官方文档 <a target="_blank" rel="noopener" href="https://pytorch.org/">PyTorch</a></p>
</li>
<li><p>关注方法需要什么参数</p>
</li>
<li><p>不知道返回值的时候：</p>
<ul>
<li>&#96;&#96;&#96;python<br>print()<br>print(type())<br>调试<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">## torchvision数据集的使用</span><br><span class="line"></span><br><span class="line">官网文档的torchvision.datasets下有很多数据集可以使用</span><br><span class="line"></span><br><span class="line">torchvision.models提供训练好的模型</span><br><span class="line"></span><br><span class="line">torchvision.transform上面讲了</span><br><span class="line"></span><br><span class="line">torchvision.utils提供小工具</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">import torchvision</span><br><span class="line"></span><br><span class="line">train_set=torchvision.datasets.CIFAR10(root=&quot;./dataset/data1&quot;,train=True,download=True) # 下载训练集</span><br><span class="line">test_set=torchvision.datasets.CIFAR10(root=&quot;./dataset/test1&quot;,train=False,download=True) # 下载测试集</span><br><span class="line"></span><br><span class="line">print(test_set[0]) # ( , )的形式，发现第一个是图片第二个是target</span><br><span class="line">print(test_set.classes) # 查看图片有哪些类型(调式看test_set有calsses属性)</span><br><span class="line"></span><br><span class="line">img,target=test_set[0] #接收( , )</span><br><span class="line">print(img)</span><br><span class="line">print(target)</span><br><span class="line">print(test_set.classes[target])</span><br><span class="line">img.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="和transform联动"><a href="#和transform联动" class="headerlink" title="和transform联动"></a>和transform联动</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">dataset_transform=torchvision.transforms.Compose([torchvision.transforms.ToTensor()]) <span class="comment"># 设置transforms</span></span><br><span class="line">train_set=torchvision.datasets.CIFAR10(root=<span class="string">&quot;./dataset/data1&quot;</span>,train=<span class="literal">True</span>,transform=dataset_transform,download=<span class="literal">True</span>) <span class="comment"># 加入transforms参数</span></span><br><span class="line">test_set=torchvision.datasets.CIFAR10(root=<span class="string">&quot;./dataset/test1&quot;</span>,train=<span class="literal">False</span>,transform=dataset_transform,download=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">writer=SummaryWriter(<span class="string">&#x27;p10&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    img,target = test_set[i]</span><br><span class="line">    writer.add_image(<span class="string">&quot;test_set&quot;</span>,img,i)</span><br><span class="line"></span><br><span class="line">writer.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/JJuprising/JJuprising.github.io@main/images/image-20220927212823149.png" alt="image-20220927212823149"></p>
<h2 id="DataLoader"><a href="#DataLoader" class="headerlink" title="DataLoader"></a>DataLoader</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备测试数据集</span></span><br><span class="line">test_data = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset/test1&quot;</span>, train=<span class="literal">False</span>, transform=torchvision.transforms.ToTensor())</span><br><span class="line">test_loader = DataLoader(dataset=test_data, batch_size=<span class="number">64</span>, shuffle=<span class="literal">True</span>, num_workers=<span class="number">0</span>, drop_last=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试数据集中第一张照片及target</span></span><br><span class="line">img, target = test_data[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(img.shape)</span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;dataloader&quot;</span>)</span><br><span class="line">step = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> test_loader:</span><br><span class="line">    imgs, targets = data  <span class="comment"># test_loader返回值是batch_size设定的一组图片打包的img和target</span></span><br><span class="line">    writer.add_images(<span class="string">&quot;test_data&quot;</span>, imgs, step)</span><br><span class="line">    step = step + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/JJuprising/JJuprising.github.io@main/images/image-20220929211159838.png" alt="image-20220929211159838"></p>
<h2 id="神经网络"><a href="#神经网络" class="headerlink" title="神经网络"></a>神经网络</h2><p><code>torch.nn</code>，Neural Network。</p>
<p><code>nn.Module</code>是所有神经网络的基类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Model</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(<span class="number">1</span>, <span class="number">20</span>, <span class="number">5</span>)</span><br><span class="line">        self.conv2 = nn.Conv2d(<span class="number">20</span>, <span class="number">20</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>): <span class="comment"># 隐藏层</span></span><br><span class="line">        x = F.relu(self.conv1(x)) <span class="comment">#  经过一次卷积然后一次非线性 </span></span><br><span class="line">        <span class="keyword">return</span> F.relu(self.conv2(x)) <span class="comment"># 输出</span></span><br><span class="line">    </span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<h3 id="卷积操作"><a href="#卷积操作" class="headerlink" title="卷积操作"></a>卷积操作</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/04/qbmG4ki3yrdASMo.png" alt="image.png"></p>
<p><strong>各种参数</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/04/VfBkvFeRrU7QELC.png" alt="image.png"></p>
<p><strong>Stride</strong></p>
<p>Stirde&#x3D;1表示卷积核在输入图像上移动一格，对应格相乘得到数；从左到右，到边界回到最左向下移动Stride然后重复操作</p>
<p><strong>padding</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/04/qaZRfAUQYKLWIpH.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>=torch.tensor([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>],</span><br><span class="line">                   [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>],</span><br><span class="line">                   [<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">                   [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">                   [<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">kernel=torch.tensor([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>],</span><br><span class="line">                     [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">                     [<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">input</span>.shape) <span class="comment"># 只有两个参数，不能直接放进卷积，要reshape</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>=torch.reshape(<span class="built_in">input</span>,(<span class="number">1</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>)) <span class="comment"># 5X5矩阵</span></span><br><span class="line">kernel=torch.reshape(kernel,(<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">input</span>.shape)</span><br><span class="line"><span class="built_in">print</span>(kernel.shape) <span class="comment"># 变成四个参数</span></span><br><span class="line"></span><br><span class="line">output=F.conv2d(<span class="built_in">input</span>,kernel,stride=<span class="number">1</span>,padding=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="comment"># torch.Size([5, 5])</span></span><br><span class="line"><span class="comment"># torch.Size([1, 1, 5, 5])</span></span><br><span class="line"><span class="comment"># torch.Size([1, 1, 3, 3])</span></span><br><span class="line"><span class="comment"># tensor([[[[ 1,  3,  4, 10,  8],</span></span><br><span class="line"><span class="comment">#           [ 7, 14, 14, 17,  9],</span></span><br><span class="line"><span class="comment">#           [ 9, 18, 18, 17,  9],</span></span><br><span class="line"><span class="comment">#           [15, 17, 14,  8,  7],</span></span><br><span class="line"><span class="comment">#           [14, 13,  9,  7,  4]]]])</span></span><br></pre></td></tr></table></figure>

<h3 id="卷积层"><a href="#卷积层" class="headerlink" title="卷积层"></a>卷积层</h3><p><code>nn.Conv1d</code>一维卷积，<code>nn.Conv2d</code>二维卷积层…</p>
<p>彩色图像一般是三通道</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CLASS torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride=<span class="number">1</span>, padding=<span class="number">0</span>, dilation=<span class="number">1</span>, groups=<span class="number">1</span>, bias=<span class="literal">True</span>, padding_mode=<span class="string">&#x27;zeros&#x27;</span>, device=<span class="literal">None</span>, dtype=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数表 输入通道数，输出通道数，卷积核大小，卷积操作步径大小，边缘填充，卷积核距离...后面都是默认参数</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/vdumoulin/conv_arithmetic/blob/master/README.md#convolution-animations">卷积层示例</a>(动图要梯子才能刷出来)</p>
<p><code>out_channels</code>设置为2时会生成两个卷积核，得到两个叠加的输出。(一般卷积操作会不断增加channels数)</p>
<p>例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision.datasets</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;/dataset/data2&quot;</span>, train=<span class="literal">False</span>, transform=torchvision.transforms.ToTensor(),</span><br><span class="line">                                       download=<span class="literal">True</span>)</span><br><span class="line">dataLoader = DataLoader(dataset, batch_size=<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyModule</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Tudui, self).__init__()</span><br><span class="line">        self.conv1 = Conv2d(in_channels=<span class="number">3</span>, out_channels=<span class="number">6</span>, kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myModule = MyModule()</span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs2&quot;</span>)</span><br><span class="line">step = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataLoader:</span><br><span class="line">    imgs, targets = data</span><br><span class="line">    output = myModule(imgs)</span><br><span class="line">    <span class="built_in">print</span>(imgs.shape)</span><br><span class="line">    <span class="built_in">print</span>(output.shape)</span><br><span class="line">    <span class="comment"># torch.Size([64,3,32,32])</span></span><br><span class="line">    writer.add_images(<span class="string">&quot;input&quot;</span>, imgs, step)</span><br><span class="line">    <span class="comment"># torch.Size([64,6,30,30]) -&gt; [xxx,3,30,30]</span></span><br><span class="line">    output = torch.reshape(output, (-<span class="number">1</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">30</span>))  <span class="comment"># 原本输出通道数变两倍，这一步相当于切开放到一个</span></span><br><span class="line">    writer.add_images(<span class="string">&quot;output&quot;</span>, output, step)</span><br><span class="line">    step = step + <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/05/bMqJYA612urv7FG.png" alt="image.png"></p>
<h3 id="池化层"><a href="#池化层" class="headerlink" title="池化层"></a>池化层</h3><p><strong>ceil_mode</strong></p>
<p>floor向下取整，ceiling向上取整。默认false不够对应不取值</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/05/o5R7AdYrMSk8lwX.png" alt="image.png"></p>
<p>实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最大池化</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> MaxPool2d</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = torch.tensor([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">                      [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">                      [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                      [<span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">                      [<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]], dtype=torch.float32)  <span class="comment"># 声明一下类型否则报错</span></span><br><span class="line"><span class="built_in">input</span> = torch.reshape(<span class="built_in">input</span>, (-<span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">input</span>.shape)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyModule</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MyModule, self).__init__()</span><br><span class="line">        self.maxpool1 = MaxPool2d(kernel_size=<span class="number">3</span>, ceil_mode=<span class="literal">False</span>) <span class="comment"># 注意ceil_mode</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,<span class="built_in">input</span></span>):</span><br><span class="line">        output=self.maxpool1(<span class="built_in">input</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">myModule = MyModule()</span><br><span class="line">output = myModule(<span class="built_in">input</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当ceilmode设置为false结果：</span></span><br><span class="line"><span class="comment"># torch.Size([1, 1, 5, 5])</span></span><br><span class="line"><span class="comment"># tensor([[[[2.]]]])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当ceilmode设置为true结果：</span></span><br><span class="line"><span class="comment"># torch.Size([1, 1, 5, 5])</span></span><br><span class="line"><span class="comment"># tensor([[[[2., 3.],</span></span><br><span class="line"><span class="comment">#           [5., 1.]]]])</span></span><br></pre></td></tr></table></figure>



<p><strong>最大池化目的为了保持原先数据的特征同时减少数据量，加快训练速度。</strong>例如720p也能大致看明白1080p视频内容</p>
<p>例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最大池化</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> MaxPool2d</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;/dataset/data2&quot;</span>, train=<span class="literal">False</span>, transform=torchvision.transforms.ToTensor(),</span><br><span class="line">                                       download=<span class="literal">True</span>)</span><br><span class="line">dataLoader = DataLoader(dataset, batch_size=<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyModule</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MyModule, self).__init__()</span><br><span class="line">        self.maxpool1 = MaxPool2d(kernel_size=<span class="number">3</span>, ceil_mode=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span></span>):</span><br><span class="line">        output = self.maxpool1(<span class="built_in">input</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myModule = MyModule()</span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;Logs_maxpool&quot;</span>)</span><br><span class="line">step = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataLoader:</span><br><span class="line">    imgs, targets = data</span><br><span class="line">    writer.add_images(<span class="string">&quot;input&quot;</span>, imgs, step)</span><br><span class="line">    output = myModule(imgs)</span><br><span class="line">    writer.add_images(<span class="string">&quot;output&quot;</span>, output, step)</span><br><span class="line">    step = step + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/05/9cvBhXPkQ6GEub3.png" alt="image.png"></p>
<p>可以看到输出图片变模糊了</p>
<h3 id="非线性激活-Non-linear"><a href="#非线性激活-Non-linear" class="headerlink" title="非线性激活 Non-linear"></a>非线性激活 Non-linear</h3><p>用到<code>ReLu()</code>或<code>Sigmoid()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Sigmoid, ReLU</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;/dataset/data2&quot;</span>, train=<span class="literal">False</span>, transform=torchvision.transforms.ToTensor(),</span><br><span class="line">                                       download=<span class="literal">True</span>)</span><br><span class="line">dataLoader = DataLoader(dataset, batch_size=<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyModule</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MyModule, self).__init__()</span><br><span class="line">        self.relu = ReLU()</span><br><span class="line">        self.sigmoid1 = Sigmoid()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span></span>):</span><br><span class="line">        output = self.sigmoid1(<span class="built_in">input</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MyModule = MyModule()</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs_relu&quot;</span>)</span><br><span class="line">step = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataLoader:</span><br><span class="line">    imgs, targets = data</span><br><span class="line">    writer.add_images(<span class="string">&quot;input&quot;</span>, imgs, global_step=step)</span><br><span class="line">    output = MyModule(imgs)</span><br><span class="line">    writer.add_images(<span class="string">&quot;output&quot;</span>, output, global_step=step)</span><br><span class="line">    step += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/07/AkmqnhzTt5SQO4a.png" alt="image.png"></p>
<p><strong>主要目的在网络中引入更多非线性特征，才能训练出符合更多特征的模型。</strong></p>
<h3 id="线性层及其他层"><a href="#线性层及其他层" class="headerlink" title="线性层及其他层"></a>线性层及其他层</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CLASS torch.nn.Linear(in_features,out_features,biass=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p><code>biass</code>表示要不要设置偏振b</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/07/IFkEvmwWp1QL23z.png" alt="image.png"></p>
<p><code>flattten()</code>展平成一行</p>
<h3 id="CRAF10小实战及Sequential"><a href="#CRAF10小实战及Sequential" class="headerlink" title="CRAF10小实战及Sequential()"></a>CRAF10小实战及Sequential()</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/07/Pqjv75cuZ6fQVsU.png" alt="image.png"></p>
<p>1、由公式计算第一步卷积得到padding是2(默认设置stride为1)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/07/HVp1tdsRDFlgBXQ.png" alt="image.png"></p>
<p>通过对每一步的解析，我们建立出一个简单的模型，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d, MaxPool2d, Flatten, Linear, Sequential</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyModule</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MyModule, self).__init__()</span><br><span class="line">        self.model1 = Sequential(</span><br><span class="line">            Conv2d(<span class="number">3</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Flatten(),</span><br><span class="line">            Linear(<span class="number">1024</span>, <span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>, <span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.model1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myModule = MyModule()</span><br><span class="line"><span class="built_in">print</span>(myModule)</span><br><span class="line"><span class="built_in">input</span> = torch.ones((<span class="number">64</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">32</span>))  <span class="comment"># torch提供的一个假设的输入</span></span><br><span class="line">output = myModule(<span class="built_in">input</span>)</span><br><span class="line"><span class="built_in">print</span>(output.shape)</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs_seq2&quot;</span>)</span><br><span class="line">writer.add_graph(myModule,<span class="built_in">input</span>)</span><br><span class="line">writer.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/07/U7kGqmLQAs2tJVo.png" alt="image.png"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/./images/ava.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/./images/ava.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">JJuprising</div><div class="post-copyright__author_desc">蓝天白云,花草树木</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://jjuprising.github.io/2022/09/27/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://jjuprising.github.io/2022/09/27/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/')">pytorch深度学习笔记</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://jjuprising.github.io/2022/09/27/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=pytorch深度学习笔记&amp;url=https://jjuprising.github.io/2022/09/27/pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/&amp;pic=/img/default.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://JJuprising.github.io" target="_blank">yjchen</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/python/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>python<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>深度学习<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/09/24/python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-dbe054265f77076e47cc1bc80532b054_1440w.jpg?source=172ae18b" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python学习笔记</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/29/Java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/10/07/XTCDJwhl5OKGyFW.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java学习笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2022/09/24/python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="python学习笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-dbe054265f77076e47cc1bc80532b054_1440w.jpg?source=172ae18b" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-09-24</div><div class="title">python学习笔记</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/./images/ava.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2021/01/15/8b962544da5c0.png" alt="status"/></div></div><div class="author-info__description"></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">JJuprising</h1><div class="author-info__desc">蓝天白云,花草树木</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/JJuprising" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://www.zhihu.com/people/bo-yi-shu-qi-49" target="_blank" title="知乎"><i class="anzhiyufont anzhiyu-icon-box-archive"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0"><span class="toc-number">1.1.</span> <span class="toc-text">机器学习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#K%E9%82%BB%E8%BF%91"><span class="toc-number">1.1.1.</span> <span class="toc-text">K邻近</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA"><span class="toc-number">1.2.</span> <span class="toc-text">多层感知机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.</span> <span class="toc-text">激活函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="toc-number">1.4.</span> <span class="toc-text">损失函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="toc-number">1.5.</span> <span class="toc-text">梯度下降</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="toc-number">1.5.1.</span> <span class="toc-text">什么是梯度下降</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8E%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="toc-number">1.5.2.</span> <span class="toc-text">神经网络与梯度下降</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85%E5%8F%82%E6%95%B0"><span class="toc-number">1.6.</span> <span class="toc-text">超参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E7%8E%87"><span class="toc-number">1.6.1.</span> <span class="toc-text">学习率</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E5%92%8C%E8%B0%83%E6%95%B4%E5%AD%A6%E4%B9%A0%E7%8E%87"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">如何设置和调整学习率</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-number">1.7.</span> <span class="toc-text">卷积神经网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B7%E7%A7%AF"><span class="toc-number">1.7.1.</span> <span class="toc-text">卷积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%87%E6%A0%B7%E5%B1%82-%E6%B1%A0%E5%8C%96%E5%B1%82%EF%BC%8Cpooling"><span class="toc-number">1.7.2.</span> <span class="toc-text">采样层(池化层，pooling)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E6%B1%A0%E5%8C%96"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">最大池化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">如何进行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%A0%E5%8C%96%E7%9A%84%E6%80%A7%E8%B4%A8"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">池化的性质</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0-1"><span class="toc-number">1.7.3.</span> <span class="toc-text">激活函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B"><span class="toc-number">1.7.3.1.</span> <span class="toc-text">线性方程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%85%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98"><span class="toc-number">1.7.3.2.</span> <span class="toc-text">待解决问题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7"><span class="toc-number">1.7.3.2.1.</span> <span class="toc-text">非线性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E9%9C%80%E8%A6%81%E8%BF%9B%E8%A1%8C%E5%88%86%E7%B1%BB"><span class="toc-number">1.7.3.2.2.</span> <span class="toc-text">输出需要进行分类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E5%8F%AF%E8%83%BD%E7%89%B9%E5%88%AB%E5%A4%A7"><span class="toc-number">1.7.3.2.3.</span> <span class="toc-text">输入可能特别大</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E6%A2%AF%E5%BA%A6%E4%B8%8E%E8%BE%93%E5%85%A5%E6%97%A0%E5%85%B3%E4%BA%86"><span class="toc-number">1.7.3.2.4.</span> <span class="toc-text">线性方程梯度与输入无关了</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0-2"><span class="toc-number">1.7.3.3.</span> <span class="toc-text">激活函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E8%BF%9E%E6%8E%A5%E5%B1%82"><span class="toc-number">1.7.4.</span> <span class="toc-text">全连接层</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E5%99%A8%E8%A7%A3%E7%A0%81%E5%99%A8"><span class="toc-number">1.8.</span> <span class="toc-text">编码器解码器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.9.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0"><span class="toc-number">2.</span> <span class="toc-text">深度学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AE%8B%E5%B7%AE%E7%BD%91%E7%BB%9CResnet"><span class="toc-number">2.1.</span> <span class="toc-text">残差网络Resnet</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6"><span class="toc-number">3.</span> <span class="toc-text">注意力机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">3.0.0.1.</span> <span class="toc-text">组件</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pytorch"><span class="toc-number">4.</span> <span class="toc-text">Pytorch</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="toc-number">4.1.</span> <span class="toc-text">加载数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BB%84%E7%BB%87%E5%BD%A2%E5%BC%8F"><span class="toc-number">4.1.1.</span> <span class="toc-text">数据的组织形式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tensorboard"><span class="toc-number">4.2.</span> <span class="toc-text">Tensorboard</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#add-scalar"><span class="toc-number">4.2.0.1.</span> <span class="toc-text">add_scalar</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#add-image"><span class="toc-number">4.2.0.2.</span> <span class="toc-text">add_image()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Transform"><span class="toc-number">4.3.</span> <span class="toc-text">Transform</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tensor%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.3.1.</span> <span class="toc-text">tensor数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ToTensor-amp-Normalize"><span class="toc-number">4.3.2.</span> <span class="toc-text">ToTensor&amp;Normalize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resize"><span class="toc-number">4.3.3.</span> <span class="toc-text">resize()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compose"><span class="toc-number">4.3.4.</span> <span class="toc-text">Compose()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RandomCrop"><span class="toc-number">4.3.5.</span> <span class="toc-text">RandomCrop()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.3.6.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%92%8Ctransform%E8%81%94%E5%8A%A8"><span class="toc-number">4.3.7.</span> <span class="toc-text">和transform联动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DataLoader"><span class="toc-number">4.4.</span> <span class="toc-text">DataLoader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-number">4.5.</span> <span class="toc-text">神经网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B7%E7%A7%AF%E6%93%8D%E4%BD%9C"><span class="toc-number">4.5.1.</span> <span class="toc-text">卷积操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B7%E7%A7%AF%E5%B1%82"><span class="toc-number">4.5.2.</span> <span class="toc-text">卷积层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%A0%E5%8C%96%E5%B1%82"><span class="toc-number">4.5.3.</span> <span class="toc-text">池化层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%BF%80%E6%B4%BB-Non-linear"><span class="toc-number">4.5.4.</span> <span class="toc-text">非线性激活 Non-linear</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%B1%82%E5%8F%8A%E5%85%B6%E4%BB%96%E5%B1%82"><span class="toc-number">4.5.5.</span> <span class="toc-text">线性层及其他层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRAF10%E5%B0%8F%E5%AE%9E%E6%88%98%E5%8F%8ASequential"><span class="toc-number">4.5.6.</span> <span class="toc-text">CRAF10小实战及Sequential()</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/05/27/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/" title="软件测试"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="软件测试"/></a><div class="content"><a class="title" href="/2024/05/27/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/" title="软件测试">软件测试</a><time datetime="2024-05-27T08:22:42.000Z" title="发表于 2024-05-27 16:22:42">2024-05-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/22/%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E7%BB%8F%E9%AA%8C/" title="论文写作经验"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="论文写作经验"/></a><div class="content"><a class="title" href="/2024/04/22/%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C%E7%BB%8F%E9%AA%8C/" title="论文写作经验">论文写作经验</a><time datetime="2024-04-22T08:47:18.000Z" title="发表于 2024-04-22 16:47:18">2024-04-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/18/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB-AlexNet/" title="AlexNet"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AlexNet"/></a><div class="content"><a class="title" href="/2024/03/18/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB-AlexNet/" title="AlexNet">AlexNet</a><time datetime="2024-03-17T16:23:18.534Z" title="发表于 2024-03-18 00:23:18">2024-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/07/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/" title="大数据原理与实践"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="大数据原理与实践"/></a><div class="content"><a class="title" href="/2024/03/07/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/" title="大数据原理与实践">大数据原理与实践</a><time datetime="2024-03-07T06:09:38.555Z" title="发表于 2024-03-07 14:09:38">2024-03-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/19/%E6%95%B0%E6%A8%A1notes/" title="数模notes"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数模notes"/></a><div class="content"><a class="title" href="/2023/11/19/%E6%95%B0%E6%A8%A1notes/" title="数模notes">数模notes</a><time datetime="2023-11-18T16:00:00.000Z" title="发表于 2023-11-19 00:00:00">2023-11-19</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="JJuprising" target="_blank">JJuprising</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">44</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 0.88rem;">C++<sup>1</sup></a><a href="/tags/DL/" style="font-size: 0.88rem;">DL<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>2</sup></a><a href="/tags/c/" style="font-size: 0.88rem;">c++<sup>1</sup></a><a href="/tags/html/" style="font-size: 0.88rem;">html<sup>2</sup></a><a href="/tags/javascript/" style="font-size: 0.88rem;">javascript<sup>1</sup></a><a href="/tags/minecraft/" style="font-size: 0.88rem;">minecraft<sup>1</sup></a><a href="/tags/python/" style="font-size: 0.88rem;">python<sup>2</sup></a><a href="/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 0.88rem;">云服务器<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 0.88rem;">前端<sup>1</sup></a><a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 0.88rem;">小程序<sup>1</sup></a><a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 0.88rem;">教程<sup>2</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 0.88rem;">数学<sup>2</sup></a><a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 0.88rem;">服务器<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 0.88rem;">笔记<sup>8</sup></a><a href="/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/" style="font-size: 0.88rem;">经验分享<sup>1</sup></a><a href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" style="font-size: 0.88rem;">编程语言<sup>6</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 0.88rem;">项目<sup>5</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 JJuprising 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>